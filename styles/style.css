body {
    margin: 0;
    padding: 0;
    overflow: hidden;
    background: #000;
    font-family: 'Courier New', monospace;
    color: white;
    /* Evita el scroll innecesario */
    user-select: none;
    /* Deshabilita la selección de texto */
    -webkit-tap-highlight-color: transparent;
    /* Mejora la experiencia táctil */
}

#game {
    display: block;
    margin: 0 auto; /* centrar horizontalmente */
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%); /* centrar en pantalla */
    border: 1px solid #444;
    background: #16191f; /* un poco más claro */
    /* CRÍTICO: El canvas debe estar DETRÁS de los overlays */
    z-index: 1;
    pointer-events: none; /* El canvas no debe capturar eventos cuando hay overlays */
}

#game-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    /* CRÍTICO: Permitir pointer events en el contenedor para que los botones funcionen */
    pointer-events: auto;
    z-index: 50;
}

.game-screen {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.85);
    color: white;
    display: none; /* Por defecto oculto */
    flex-direction: column;
    justify-content: center;
    align-items: center;
    pointer-events: all;
    z-index: 100;
}
#resource-panel {
    position: absolute;
    top: 70px;
    left: 50%;
    transform: translateX(-50%);
    padding: 10px 15px;
    background: rgba(0, 0, 0, 0.75);
    border: 1px solid #394e5a;
    font-size: 1.05rem;
    color: #d7e3ef;
}
.hidden {
    display: none !important;
}

.visible {
    display: flex !important;
}
#menu-screen {
    background: radial-gradient(1100px 640px at 50% 35%, rgba(90,15,15,0.55) 0%, rgba(20,5,8,0.85) 55%, rgba(12,3,6,0.94) 100%),
                radial-gradient(1000px 620px at 20% 80%, rgba(150,20,20,0.18) 0%, transparent 70%),
                radial-gradient(900px 540px at 80% 70%, rgba(255,60,60,0.15) 0%, transparent 75%),
                linear-gradient(180deg, #120204 0%, #1c070b 50%, #0b0203 100%);
    overflow: hidden;
}

/* Menu inner layout */
.menu-inner{
    position: relative;
    display:flex; flex-direction:column; align-items:center; justify-content:center;
    width:100%; height:100%;
    gap:22px;
    z-index: 110;
}

.title-cluster{ text-align:center; margin-top:-30px; }
.game-title{
    position: relative;
    font-family: 'Courier New', monospace;
    font-weight: 700;
    font-size: clamp(42px, 6vw, 78px);
    letter-spacing: 6px;
    color: #ffd7d7;
    text-shadow: 0 0 14px rgba(255,80,80,0.52), 0 0 40px rgba(255,40,40,0.22);
}
.game-title::after{
    content: attr(data-text);
    position:absolute; left:0; top:0; right:0;
    color: transparent;
    -webkit-text-stroke: 1px rgba(255,120,120,0.7);
    text-shadow: 0 0 28px rgba(255,90,90,0.45);
    mix-blend-mode: screen;
    animation: titleGlow 4s ease-in-out infinite;
}
@keyframes titleGlow {
    0%,100% { filter: drop-shadow(0 0 0 rgba(255,90,90,0.0)); opacity: 0.82; }
    50%     { filter: drop-shadow(0 0 18px rgba(255,60,60,0.55)); opacity: 1; }
}
.game-sub{
    margin-top: -6px;
    color:#ffb1b1;
    font-weight: 400;
    letter-spacing: 2px;
}

.slogan{
    margin-top: 6px;
    color:#ff9f9f;
    font-size: 0.95rem;
    letter-spacing: 2.5px;
    text-transform: uppercase;
    opacity: 0.9;
}

.start-btn{
    position: relative;
    border: none;
    background: transparent;
    cursor: pointer;
    padding: 0; margin-top: 10px;
    transform: translateZ(0);
}
.start-btn .btn-bg{
    position: absolute; inset: 0; border-radius: 10px;
    background: radial-gradient(140px 50px at 50% 50%, rgba(220,40,40,0.75) 0%, rgba(160,20,20,0.25) 65%, rgba(120,10,10,0) 100%);
    filter: blur(12px);
    transform: scale(1);
    animation: pulseGlow 2.4s ease-in-out infinite;
}
@keyframes pulseGlow { 0%,100% { opacity: 0.75; } 50% { opacity: 1; } }
.start-btn .btn-text{
    position: relative;
    display:inline-block;
    padding: 16px 34px;
    border-radius: 10px;
    background: linear-gradient(180deg, #c82d2d 0%, #8e1212 100%);
    box-shadow: 0 10px 28px rgba(180,20,20,0.35), inset 0 1px 0 rgba(255,230,230,0.4);
    border: 1px solid #ff4c4c;
    color: #ffecec; letter-spacing: 1.6px; font-weight: 700;
    text-shadow: 0 1px 0 rgba(0,0,0,0.4);
    transition: transform .15s ease, filter .15s ease, box-shadow .2s ease;
}
.start-btn:hover .btn-text{ transform: translateY(-1px) scale(1.02); filter: saturate(1.15); box-shadow: 0 16px 42px rgba(200,40,40,0.50), inset 0 1px 0 rgba(255,240,240,0.55); }
.start-btn:active .btn-text{ transform: translateY(0); }

.secondary-btn{
    margin-top: 16px;
    padding: 10px 22px;
    background: rgba(0,0,0,0.4);
    border: 1px solid rgba(255,200,200,0.4);
    color: #ffe2e2;
    font-size: 0.95rem;
}
.secondary-btn:hover{
    background: rgba(0,0,0,0.6);
    border-color: rgba(255,220,220,0.7);
}

.start-btn.small .btn-text{
    padding: 10px 24px;
    font-size: 0.95rem;
}

/* Ambient orbs */
.ambient-lights .al{ position:absolute; border-radius:50%; filter: blur(28px); opacity:0.35; z-index: 90; }
.ambient-lights .orb1{ width:420px; height:420px; left:-120px; top:-120px; background: radial-gradient(circle, rgba(150,30,30,0.55), rgba(150,30,30,0)); animation: float1 10s ease-in-out infinite; }
.ambient-lights .orb2{ width:360px; height:360px; right:-80px; bottom:-60px; background: radial-gradient(circle, rgba(255,60,60,0.42), rgba(255,60,60,0)); animation: float2 12s ease-in-out infinite; }
.ambient-lights .orb3{ width:300px; height:300px; left:60%; top:70%; transform: translate(-50%,-50%); background: radial-gradient(circle, rgba(255,100,100,0.30), rgba(255,100,100,0)); animation: float3 14s ease-in-out infinite; }
@keyframes float1 { 0%,100%{ transform: translate(0,0); } 50% { transform: translate(10px,16px); } }
@keyframes float2 { 0%,100%{ transform: translate(0,0); } 50% { transform: translate(-12px,-10px); } }
@keyframes float3 { 0%,100%{ transform: translate(-50%,-50%) scale(1); } 50% { transform: translate(-50%,-50%) scale(1.06); } }

/* CRT scanlines + noise overlay for gritty vibe */
.scanlines{ position:absolute; inset:0; pointer-events:none; z-index:95; background-image: repeating-linear-gradient(to bottom, rgba(255,100,100,0.03) 0, rgba(255,100,100,0.03) 1px, transparent 1px, transparent 3px); mix-blend-mode: overlay; opacity:0.22; }
.noise-layer{ position:absolute; inset:0; pointer-events:none; z-index:96; background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><filter id="n"><feTurbulence type="fractalNoise" baseFrequency="0.8" numOctaves="2" stitchTiles="stitch"/></filter><rect width="100%" height="100%" filter="url(%23n)" opacity="0.07"/></svg>'); opacity:0.15; animation: noiseShift 1.5s steps(2,end) infinite; }
@keyframes noiseShift { 0%{ transform: translate3d(0,0,0);} 50%{ transform: translate3d(-5px,3px,0);} 100%{ transform: translate3d(0,0,0);} }

/* HUD y Paneles */
#hud{ position:fixed; inset:0; pointer-events:none; z-index:130; }
.hud-left{ position:absolute; top:16px; left:16px; display:flex; flex-direction:column; gap:8px; }
.hud-center{ position:absolute; top:16px; left:50%; transform:translateX(-50%); }
.hud-right{ position:absolute; top:16px; right:16px; }
.hud-bottom-left{ position:absolute; bottom:12px; left:16px; }

.hearts, .keys{ display:flex; gap:8px; }
.heart, .key{ width:28px; height:28px; display:inline-block; opacity:0.35; filter: grayscale(40%); transition: opacity .2s ease, filter .2s ease, transform .15s ease; }
.heart.active, .key.active{ opacity:1; filter:none; }
.heart.active{ filter: drop-shadow(0 0 6px rgba(255,80,90,0.6)); }
.key.active{ filter: drop-shadow(0 0 6px rgba(255,220,90,0.6)); }

/* Heart via inline SVG data-URI */
.heart{
    background-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='64' height='64' viewBox='0 0 64 64'><defs><linearGradient id='g' x1='0' y1='0' x2='0' y2='1'><stop offset='0%' stop-color='%23ff6b6b'/><stop offset='100%' stop-color='%23b11226'/></linearGradient></defs><path d='M32 57s-9.6-8.2-16.2-14.8C9.7 36.1 6 31.6 6 26c0-6.1 4.7-11 10.5-11 4.5 0 7.6 2.4 9.5 5.6C28 17.4 31.1 15 35.6 15 41.3 15 46 19.9 46 26c0 5.6-3.7 10.1-9.8 16.2C41.6 48.8 32 57 32 57z' fill='url(%23g)' stroke='%23ffb3b3' stroke-width='1.2'/></svg>");
    background-size: contain; background-repeat:no-repeat; background-position:center;
}

/* Keys use existing svg assets; use key1 for all for now */
.key{ background-image:url('../assets/img/key1.svg'); background-size:contain; background-repeat:no-repeat; background-position:center; }

.timer-badge{ pointer-events:none; background: rgba(0,0,0,0.55); border:1px solid rgba(255,255,255,0.18); padding:8px 12px; border-radius:10px; color:#fff; font-weight:700; letter-spacing:1px; font-size:1.1rem; box-shadow: 0 6px 18px rgba(0,0,0,0.25); }

/* panel HUD duplicado arriba se mantiene posicionado por regla anterior */

.mute-indicator{
    display:inline-flex;
    align-items:center;
    justify-content:center;
    width:32px;
    height:32px;
    border-radius:50%;
    border:1px solid rgba(255,255,255,0.4);
    background:rgba(0,0,0,0.6);
    color:#ffbcbc;
    font-size:18px;
    box-shadow:0 4px 12px rgba(0,0,0,0.5);
}

/* Game Over screen enhancements */
#gameover-screen {
    display: none;
    justify-content: center;
    align-items: center;
    background: radial-gradient(circle at 50% 20%, rgba(180,30,30,0.35), rgba(0,0,0,0.95));
}

#gameover-screen .gameover-inner {
    position: relative;
    padding: 28px 32px;
    background: rgba(8, 0, 0, 0.9);
    border: 1px solid rgba(255, 90, 90, 0.6);
    box-shadow: 0 16px 40px rgba(0, 0, 0, 0.85);
    text-align: center;
    max-width: 520px;
}

#gameover-screen h1 {
    margin: 0 0 10px;
    font-size: 2.6rem;
    letter-spacing: 6px;
    color: #ffb0b0;
    text-shadow: 0 0 14px rgba(255, 70, 70, 0.7);
}

#gameover-message {
    margin: 4px 0 10px;
    color: #ffd9d9;
}

#gameover-score-summary {
    margin-top: 6px;
    font-size: 0.98rem;
    color: #f4bcbc;
    opacity: 0.9;
}

.gameover-buttons {
    margin-top: 18px;
}

/* Botones en las pantallas del juego */
button {
    padding: 12px 24px;
    background: #2a4;
    color: white;
    border: 2px solid #4c6;
    cursor: pointer;
    font-size: 1.1rem;
    font-family: 'Courier New', monospace;
    margin: 10px;
    transition: all 0.2s;
}

button:hover {
    background: #3b5;
    border-color: #6e8;
    transform: scale(1.05);
}

/* Alert overlay */
#alert-layer {
    position: fixed;
    top:0;left:0;right:0;bottom:0;
    pointer-events:none;
    display:flex;
    justify-content:center;
    align-items:flex-start;
    padding-top:100px;
    z-index:150;
    font-family:'Courier New', monospace;
}
#alert-layer,
#hud-alert {
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 1000;
    pointer-events: none;
    /* evita bloquear clics del juego */
    width: 100%;
    display: flex;
    justify-content: center;
}

/* permitir interacción dentro del anuncio si la hay */
#alert-layer>*,
#hud-alert>* {
    pointer-events: auto;
}

/* Instrucciones */
#instructions-screen {
    background: radial-gradient(900px 520px at 50% 10%, rgba(80,20,20,0.7) 0%, rgba(10,2,4,0.96) 60%, #050104 100%);
}
.instructions-inner{
    position: relative;
    max-width: 720px;
    padding: 28px 32px;
    background: rgba(5,0,0,0.92);
    border-radius: 14px;
    border: 1px solid rgba(255,140,140,0.3);
    box-shadow: 0 20px 50px rgba(0,0,0,0.8);
    z-index: 120;
}
.instructions-inner h1{
    margin-top: 0;
    margin-bottom: 10px;
    font-size: 1.8rem;
    letter-spacing: 3px;
}
.instr-section-title{
    margin-top: 14px;
    margin-bottom: 4px;
    font-weight: 700;
    color: #ffb3b3;
    text-transform: uppercase;
    font-size: 0.95rem;
}
.instr-list{
    list-style: none;
    padding-left: 0;
    margin-top: 6px;
    margin-bottom: 6px;
}
.instr-list li{
    margin-bottom: 4px;
}
.instr-buttons{
    margin-top: 18px;
    display:flex;
    gap: 10px;
    justify-content:flex-end;
}

/* Pausa */
.overlay-screen{
    position:absolute;
    inset:0;
    display:flex;
    align-items:center;
    justify-content:center;
    background: rgba(0,0,0,0.65);
    z-index: 160;
}
.pause-inner{
    max-width: 520px;
    padding: 24px 30px;
    background: rgba(5,0,0,0.95);
    border-radius: 12px;
    border: 1px solid rgba(255,160,160,0.3);
    box-shadow: 0 18px 46px rgba(0,0,0,0.85);
    text-align: center;
}
.pause-inner h1{
    margin-top: 0;
    margin-bottom: 8px;
}
.pause-buttons{
    margin-top: 16px;
    display:flex;
    gap: 10px;
    justify-content:center;
}

.game-alert {
    background: rgba(180,0,0,0.18);
    border:2px solid #ff4444;
    color:#ffdddd;
    padding:14px 22px;
    font-size:1.3rem;
    text-shadow:0 0 6px #ff4444;
    /* Duración alineada con la vida del anuncio en JS (6000 ms) */
    animation: alertFade 4.2s ease-out forwards;
}
@keyframes alertFade {
    0%   { transform:translateY(-20px); opacity:0; }
    10%  { transform:translateY(0);    opacity:1; }
    70%  { opacity:1; }
    100% { opacity:0; }
}

/* Timer centrado arriba: ahora gestionado por #hud-time en el HUD */